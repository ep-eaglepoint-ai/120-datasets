<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Message Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1>Message Dashboard</h1>
        <p>Welcome, {{ user.username }} ({{ user_role }})</p>
        
        <a href="{% url 'message_create' %}" class="btn btn-primary mb-3">Create New Message</a>
        
        <ul class="nav nav-tabs" id="messageTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="all-tab" data-bs-toggle="tab" data-bs-target="#all" type="button" role="tab">All Messages</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="user-tab" data-bs-toggle="tab" data-bs-target="#user" type="button" role="tab">User Messages</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="admin-tab" data-bs-toggle="tab" data-bs-target="#admin" type="button" role="tab">Admin Messages</button>
            </li>
        </ul>
        
        <div class="tab-content" id="messageTabsContent">
            <div class="tab-pane fade show active" id="all" role="tabpanel">
                <h3>All Messages</h3>
                {% for message in all_messages %}
                <div class="card mb-3">
                    <div class="card-body">
                        <h5 class="card-title">{{ message.title }}</h5>
                        <p class="card-text">{{ message.content }}</p>
                        <p class="card-text"><small class="text-muted">By {{ message.author.username }} on {{ message.created_at }}</small></p>
                        {% if message.author == user %}
                        <a href="{% url 'message_update' message.pk %}" class="btn btn-sm btn-secondary">Edit</a>
                        <a href="{% url 'message_delete' message.pk %}" class="btn btn-sm btn-danger">Delete</a>
                        {% endif %}
                    </div>
                </div>
                {% empty %}
                <p>No messages available.</p>
                {% endfor %}
            </div>
            
            <div class="tab-pane fade" id="user" role="tabpanel">
                <h3>Your Messages</h3>
                {% for message in user_messages %}
                <div class="card mb-3">
                    <div class="card-body">
                        <h5 class="card-title">{{ message.title }}</h5>
                        <p class="card-text">{{ message.content }}</p>
                        <p class="card-text"><small class="text-muted">By {{ message.author.username }} on {{ message.created_at }}</small></p>
                        <a href="{% url 'message_update' message.pk %}" class="btn btn-sm btn-secondary">Edit</a>
                        <a href="{% url 'message_delete' message.pk %}" class="btn btn-sm btn-danger">Delete</a>
                    </div>
                </div>
                {% empty %}
                <p>You haven't created any messages yet.</p>
                {% endfor %}
            </div>
            
            <div class="tab-pane fade" id="admin" role="tabpanel">
                <h3>Admin Messages</h3>
                {% for message in admin_messages %}
                <div class="card mb-3">
                    <div class="card-body">
                        <h5 class="card-title">{{ message.title }}</h5>
                        <p class="card-text">{{ message.content }}</p>
                        <p class="card-text"><small class="text-muted">By {{ message.author.username }} on {{ message.created_at }}</small></p>
                    </div>
                </div>
                {% empty %}
                <p>No admin messages available.</p>
                {% endfor %}
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>